
---
#### 컴퓨터의 기본 구성
- 제어 장치 : 컴퓨터의 모든 동작을 제어하는 CPU의 핵심 장치
- ALU, I/O 장치에 프로세서가 전송한 명령어 수행
- 주기억 장치의 명령어를 읽어 CPU의 명령 레지스터 IR로 가져오고,
- 명령 레지스터의 opcode를 해독하여 제어 신호를 발생

#### 1. 컴퓨터 시스템의 구성
- 제어 장치의 기본 기능
	- CPU에 접속된 장치들에 대한 데이터 이동 순서 조정
	- 명령어 해독
	- CPU 내 데이터 흐름 제어
	- 외부 명령을 받아 일련의 제어 신호 생성
	- 실행 장치 (예를 들어 ALU, 데이터 버퍼, 레지스터) 제어
	- 명령어 인출, 명령어 해독, 명령어 실행 등을 순서에 맞추어 처리

#### 일련의 제어신호 동작

	![[Pasted image 20240520183005.png]]
	![[Pasted image 20240520183032.png]]

#### 2. 제어 장치의 종류
##### 1. 하드와이어 제어 장치 (hardwired control)
- 논리 회로로 만들어진 하드웨어로 명령어 실행 제어에 필요한 제어 신호 발생
- 회로 구조를 물리적으로 변경하지 않고는 신호 생성 방법을 수정할 수 없음
- 명령어의 opcode에 제어 신호를 생성하는 기본 데이터 포함
- 명령 디코더에서 명령 코드가 해독
- 명령 디코더는 명령어 opcode에 정의된 여러 필드를 해독하는 많은 해독기 세트로 구성
- 제어 하드웨어는 상태 기계(state machine)처럼 클록 사이클이 진행됨에 따라 상태가 변함
- 명령 레지스터, 상태 코드, 외부 입력 등에 따라 다르게 변함
- 프로그래밍 가능한 논리 배열(PLA: Programmable Logic Array)과 유사한 방식으로 구성
	- 논리식으로 설계한 고정된 논리 회로에 의해 제어 신호 생성
	- 하드와이어 제어 장치는 마이크로 프로그램 제어 장치보다 빠름
	- 고속으로 작동
	
	![[Pasted image 20240520183431.png]]
- 명령어 실행을 위한 제어 신호는 명령어 실행 사이클 전 구간에서 끊임없이 생성
- 인출 초기 : 새 명령이 제어 장치에 도착
- 명령어 해독 : 새 명령 실행과 관련된 첫 번째 상태 시작
	- 컴퓨터의 플래그 및 상태 정보가 변경되지 않은 상태로 유지되는 한 지속
	- 이들 신호 중 어떤 것이라도 변경이 일어나면 제어 장치 상태도 변경이 일어남
- 제어 신호 발생 회로에 대한 각각의 새 입력이 생성
	- 외부 신호가 나타날 때(예: 인터럽트) 외부 신호에 대한 반응(예; 인터럽트 처리)과 관련된 상태가 됨
	- 컴퓨터의 플래그와 상태 변수 값은 명령어 실행 주기에 적합한 상태를 선택하는 데 사용
- 사이클의 마지막 상태 : 프로그램의 다음 명령을 가져오기 시작하는 제어 상태
	- 프로그램 카운터의 내용을 MAR로 보내고
	- 컴퓨터의 명령 레지스터에 대한 명령어를 읽음
	- 프로그램 실행 종료 명령 : 운영체제 상태로 돌아감
	
	![[Pasted image 20240520183800.png]]

##### 2. 마이크로 프로그램 제어 장치 (micro-programmed control)
- 하드와이어 제어 장치와 근본적인 차이 : 제어 메모리 control memory의 존재 여부
- 각 명령 실행 순서에 해당하는 일련의 해독된 제어 신호를 비트 패턴으로 만들어 제어 메모리에 저장
- 명령 인출과정은 하드와이어 제어 장치와 동일
- 그러나 각 명령의 opcode가 제어 신호를 생성하기 위해 제어 메모리에서 해당 마이크로 프로그램의 시작 주소 지시
	- 명령 레지스터의 opcode가 제어 메모리의 제어 주소 레지스터 CMAR로 전송되고,
	- 마이크로 프로그램의 첫 번째 마이크로 명령이 마이크로 명령 레지스터로 읽힌다.
	- 마이크로 명령 : 인코딩된 형태로 연산코드 제공
	- 마이크로 명령 해독기에서 연산 코드 필드 해독
	
	![[Pasted image 20240520184106.png]]
- 마이크로 명령 : 다음 마이크로 명령의 주소 포함
- 하나의 제어 필드는 마이크로 명령 주소 발생 장치를 제어하는 신호로 사용
- 마이크로 명령 주소 발생 장치 : 마이크로 명령 루틴의 시작 주소 생성
- 주소 발생 장치는 사상 함수에 opcode를 연결하여 루틴의 시작 주소를 생성
	- 사상 함수는 명령어 개수가 적고 체계적일 때는 효율적이지만, 명령어 개수가 많아지고 이전 버전 명령 세트에 계속적으로 추가될 때는 점점 더 복잡해짐.
	- 주소 발생 장치는 사상 함수뿐만 아니라 덧셈이나 기타 다른 연산을 추가하여 주소를 찾아냄
	
	![[Pasted image 20240520184339.png]]
- 마이크로 명령 설계 순서
	- 1. 필요한 제어 신호의 목록 작성
	- 2. 유사한 의미를 가진 제어 신호를 그룹화하여 필드 구성
	- 3. 각 필드에 논리적인 순서 부여 : 예를 들어 ALU 연산과 ALU 피연산자를 앞에 두고 이어서 실행될 마이크로 명령의 제어 메모리 주소를 뒤에 둔다
	- 4. 마이크로 명령 형식에 대한 기호 범례를 작성하여 필드 값의 이름과 제어 신호 설정 방법 작성
	- 5. 필드 폭을 최소화하기 위해 동시에 사용하지 않는 작업을 분리하여 인코딩
- 마이크로 명령을 설계한 후 이를 기반으로 명령어 사이클인 명령어 인출, 해독, 실행 각각에 대한 마이크로 프로그램 루틴 작성
- 명령어 실행(연산) 사이클은 모든 기계어 명령마다 다르므로 일일이 정의
- 제어 신호는 프로그래머가 접근할 수 없는 제어 메모리에 제어 워드로 저장
- 프로그램으로 생성되는 제어 신호는 기계어와 유사
- 제어 기억 장치에서 마이크로 명령을 읽어 오기 때문에 속도가 느림
	
	![[Pasted image 20240520184719.png]]


##### 3. 마이크로 프로그램 제어 장치의 종류
- 수평적 마이크로 프로그램
	- 제어 신호가 제어 신호당 1비트로 해독된 2진 형식으로 표현
		- 예를 들어 프로세서에 제어 신호가 50개 있다면 50비트의 제어 신호 필요
		- 한번에 2개 이상의 제어 신호를 활성화할 수 있음
	- 수평적 마이크로 프로그램의 특징
		- 제어 워드가 더 길다.
		- 병렬 처리 응용에 사용된다.
		- 더 높은 수준의 병렬 처리 가능 : 병렬성이 N이면 한 번에 N개의 제어 신호 활성화 된다.
		- 추가 하드웨어(디코더)가 필요치 않음 => 수직적 마이크로 프로그래밍보다 빠름
		
	![[Pasted image 20240520184959.png]]
- 수직적 마이크로 프로그램
	- 수직적 마이크로 프로그램에서는 제어 신호가 인코딩된 2진 형식으로 표시
	- N개 제어 신호가 필요할 경우 $log2N$비트 필요
	- 수직적 마이크로 프로그램의 특징
		- 제어 워드가 더 짧다.
		- 유연하므로 새로운 제어 신호를 추가하기 용이
		- 낮은 수준의 병렬화 허용
		- 제어 신호를 생성하는 추가적인 하드웨어 필요 => 수평적 마이크로 프로그래밍보다 느림
		
		![[Pasted image 20240520185154.png]]


##### 4. 하드와이어 제어와 마이크로 프로그램 제어 비교

	![[Pasted image 20240520185243.png]]
- 하드와이어 제어와 마이크로 프로그램 제어를 적절히 혼용하여 hybrid 제어 장치 구성
	
	![[Pasted image 20240520185332.png]]


#### 3. 명령어 사이클
##### 명령어 사이클
- 명령어 인출 -> 명령어 해독 -> 명령ㅇ