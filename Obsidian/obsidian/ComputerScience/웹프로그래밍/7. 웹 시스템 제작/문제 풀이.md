
---
![[Pasted image 20240605150904.png]]


---
![[Pasted image 20240605150923.png]]

```java
import java.time.LocalDateTime;

@Entity
public class member {
	@Id public String id;
	public String pw;
	public String name;
	public Integer mileage;
	@CreationTimestamp
	public LocalDateTime rdate;
}
```
---
![[Pasted image 20240605150949.png]]

```java

public interface memberRep extends JpaRepository<member, String> {
	@Query("select count(id) from member")
	int memberCount ();
}
```
---
![[Pasted image 20240605151030.png]]

```java

@Controller
public class MyController {
	@Autowired
	private memberRep mrep;
}
```
---
![[Pasted image 20240605151520.png]]

```html
<!DOCTYPE html> 
<html xmlns:th="http://www.thymeleaf.org"> 
<head><meta charset="UTF-8"><title>회원 가입</title> 
<style> 
body {background-color:#F8ECE0; } 
fieldset {background-color:#F8ECE0; }
button {margin-left:20px; } 
</style></head> 
<body> 
<form method="get" action="/member/insert"><p> 
<fieldset> 
<legend><strong>회원 정보를 입력하세요</strong></legend><br> 
<table> 
<tr> <td>ID <td><input type="text" name="id" required> 
<tr> <td>PW <td><input type="text" name="pw" required> 
<tr> <td>이름<td><input type="text" name="name" required>
<tr> <td>폰 <td><input type="text" name="phone" required> 
</table><br>
</fieldset> <br>
<a href="login">취소(로그인 화면으로)</a>
<input type="submit" value="등록">
</form> 
</body></html>
```

```java
@GetMapping("/member")
public String member() {
	return "member";
}
```
---
![[Pasted image 20240605151939.png]]

```java
@GetMapping("/member/insert") 
public String memberInsert( @RequestParam("id") String id, 
						    @RequestParam("pw") String pw,
							@RequestParam("name") String name,
							@RequestParam("phone") String phone,
							RedirectAttributes re) {
	 if(mrep.existsById(id)) { 
		re.addAttribute("msg", id+"는 이미 사용되고 있는 아이디입니다.");
		re.addAttribute("url", "back"); 
	} 
	else { 
		member m = new member(); 
		m.id = id; 
		m.pw = pw; 
		m.name = name; 
		m.phone = phone; 
		m.mileage = 0; ;
		
		mrep.save(m);
		re.addAttribute("msg", id+"님, 반갑습니다!! (로그인 화면으로 이동)"); 
		re.addAttribute("url", "/login"); 
	} 
	return "redirect:/popup";
}
```

---
![[Pasted image 20240605152840.png]]

```html
<!DOCTYPE html> 
<html xmlns:th="http://www.thymeleaf.org"> 
<head><meta charset="UTF-8"> 
<title>안내글</title></head> 
<body> 
<script th:inline="javascript"> 
	m = [[${msg}]]; 
	u = [[${url}]]; 
	alert(m); 
	if(u == 'back') 
		history.back(); 
	else 
		location.a.href = u; 
</script> 
</body> </html>
```
```java
@GetMapping("/popup") 
public String popup(@RequestParam("msg") String msg, 
					@RequestParam("url") String url, Model mo) { 
	mo.addAttribute("msg",msg); 
	mo.addAttribute("url",url); 
	return "popup"; 
}
```

---
![[Pasted image 20240607133310.png]]

```java
@GetMapping("/login/check") 
public String loginCheck(HttpSession se, @RequestParam("id"),
						 RedirectAttributes re) { 
	if(mrep.existsById(id)) { 
		se.setAttribute("id", id); 
		return "redirect:/menu"; 
	} 
	else {
		re.addAttribute("msg", id +"는 미등록 아이디입니다. 확인 후 로그인 부탁드립니다."); 
		re.addAttribute("url", "/login"); 
		return "redirect:/popup";
	} 
}
```

---
![[Pasted image 20240607134517.png]]

(3)

---
![[Pasted image 20240607134613.png]]

```html
<Style>
	body {background-color:green;}
	#sp1 {color:blue;}
</style>
<body>
<hr>
<span id="sp1" th:text="${id}">id</span>님, 어떤 업무를 하시겠습니까?
<hr>
</body>
```

---
![[Pasted image 20240607134936.png]]

```html
<!DOCTYPE html> 
<html xmlns:th="http://www.thymeleaf.org"> <head><meta charset="UTF-8"><title>나의 정보</title> 
<style> 
body {background-color:rgb(185, 253, 130);} 
#sp1 { color:blue; } 
table { width:300px; } 
</style></head> 
<body> <h3><span id="sp1" th:text="${m.id}">id</span>님의 정보</h3> 
<table> 
<tr><td>비번 <td><input th:value="${m.pw}" disabled> 
<tr><td>이름 <td><input th:value="${m.name}" disabled> 
<tr><td>폰 <td><input th:value="${m.phone}" disabled> 
<tr><td>마일리지 <td><input th:value="${m.mileage}" disabled> 
<tr><td>가입 일시 <td><input th:value="${m.rdate}" disabled> 
</table><p> 
<a href="/menu">메뉴로 돌아가기</a> 
</body></html>
```
```java
@GetMapping("/myinfo") 
public String myinfo(HttpSession se, Model mo) { 
	String id = (String)se.getAttribute("id");
	mo.addAttribute("m",mrep.findById(id).get()); 
	return "myinfo"; 
}
```
	jpa에서 제공하는 여러 메소드들이 있습니다.
	리파지토리면 수명 .메소드명 이렇게 사용하시면 됩니다.
	예를 들어 변수가 mrep일 때
	 우리가 이번에 사용하는 건 4가지
	 (1) mrep.save(m) -> insert 할 때
	 (2) mrep.finById(id).get() -> row 1개 select 해 올 때
	 (3) mrep.existsById(id) -> 데이터가 존재하는지(true) 안하는지(false) 체크할 때
	 (4) mrep.findAll() -> select * 해와서 배열에 넘겨줌