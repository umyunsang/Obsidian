#ComputerScience #확률과통계 

---
### Bayes' 이론

- **핵심내용**:
  - Bayes' 이론은 주어진 증거를 고려하여 사건의 사후 확률을 추론하는 방법입니다.
  - 주어진 증거 $E$가 주어졌을 때, 사건 $B$의 발생 확률을 업데이트합니다.

- **수식**:
  - Bayes' 이론은 다음과 같이 표현됩니다:
    $$ P(B|E) = \frac{P(E|B) \cdot P(B)}{P(E)} $$
    여기서:
    - $P(B|E)$: 사후 확률 (증거 $E$가 주어졌을 때 사건 $B$의 확률)
    - $P(E|B)$: 가능도 (사건 $B$가 주어졌을 때 증거 $E$의 확률)
    - $P(B)$: 사전 확률 (사건 $B$의 확률)
    - $P(E)$: 주변 확률 (증거 $E$의 확률)

- **사후 확률 계산**:
  1. **가능도 $P(E|B)$ 계산**: 주어진 사건 $B$에 대한 증거 $E$의 발생 확률을 계산합니다.
  2. **사전 확률 $P(B)$ 계산**: 사전 정보를 바탕으로 사건 $B$의 발생 확률을 계산합니다.
  3. **주변 확률 $P(E)$ 계산**: 증거 $E$가 발생할 확률을 계산합니다.
  4. **Bayes' 이론을 적용하여 사후 확률 $P(B|E)$ 계산**:
     $$ P(B|E) = \frac{P(E|B) \cdot P(B)}{P(E)} $$

- **사후 확률의 의미**:
  - Bayes' 이론은 증거를 통해 사건의 확률을 업데이트하여 더 나은 추론을 할 수 있도록 합니다. 증거 $E$가 주어졌을 때, 사건 $B$의 발생 확률을 추론합니다.

### 주변 확률 $P(E)$ 계산

- **주변 확률**:
  - 주변 확률은 특정 사건이 발생할 확률입니다.
  - 여러 사건이 동시에 발생할 수 있는 경우, 모든 가능한 경우의 확률을 합한 것입니다.

- **계산 방법**:
  - 주변 확률 $P(E)$를 계산하기 위해 베이즈 이론을 활용하여 다음과 같이 계산할 수 있습니다:
    $$ P(E) = P(E|B) \cdot P(B) + P(E|B') \cdot P(B') $$
    여기서 $B'$는 사건 $B$의 여집합을 나타냅니다.

### Bayes' 이론의 확장: Unknown Normalization Constant

#### 핵심내용:
Bayes' 이론은 주어진 증거를 바탕으로 사후 확률을 추론하는데 사용됩니다. 그러나 때로는 증거의 주변 확률이 계산하기 어려운 경우가 있습니다. 이때 사용되는 Unknown Normalization Constant는 이 확률을 추정하는 데 도움이 됩니다.

#### 수식:
Unknown Normalization Constant를 적용한 Bayes' 이론의 수식은 다음과 같이 표현됩니다:
$$ P(B|E) = \frac{P(E|B) \cdot P(B)}{\sum_{i} P(E|B_i) \cdot P(B_i)} $$
여기서:
- $P(B|E)$: 사후 확률 (증거 $E$가 주어졌을 때 사건 $B$의 확률)
- $P(E|B)$: 가능도 (사건 $B$가 주어졌을 때 증거 $E$의 확률)
- $P(B)$: 사전 확률 (사건 $B$의 확률)
- $\sum_{i} P(E|B_i) \cdot P(B_i)$: 주변 확률의 추정치로서, 모든 가능한 사건 $B_i$에 대한 가능도와 사전 확률의 합

### Bayes' 이론과 일반적인 총 확률의 법칙

#### 핵심내용:
Bayes' 이론은 일반적인 총 확률의 법칙과 결합하여 복잡한 문제를 해결하는 데 사용됩니다. 이 법칙은 주어진 증거의 조건 하에서 사전 확률을 계산하는 데 유용합니다.

#### 수식:
Bayes' 이론과 총 확률의 법칙을 결합한 수식은 다음과 같습니다:
$$ P(B|E) = \frac{P(E|B) \cdot P(B)}{P(E)} $$
$$ P(E) = \sum_{i} P(E|B_i) \cdot P(B_i) $$
여기서:
- $P(B|E)$: 사후 확률 (증거 $E$가 주어졌을 때 사건 $B$의 확률)
- $P(E|B)$: 가능도 (사건 $B$가 주어졌을 때 증거 $E$의 확률)
- $P(B)$: 사전 확률 (사건 $B$의 확률)
- $\sum_{i} P(E|B_i) \cdot P(B_i)$: 증거 $E$의 주변 확률으로서, 모든 가능한 사건 $B_i$에 대한 가능도와 사전 확률의 합

### 예시: 병 검사

가정:
- 어떤 질병에 걸렸을 때 특정 검사는 양성 또는 음성 결과를 보여줍니다.
- 검사는 95%의 정확도를 가지며, 질병에 걸린 사람이 양성 결과를 보일 확률은 99%입니다.
- 전체 인구 중 1%가 해당 질병에 걸렸다고 가정합니다.

주어진 정보:
- 사전 확률 $P(A)$ : 질병에 걸렸을 확률 = 0.01
- 가능도 $P(B|A)$ : 양성 결과가 나올 확률 = 0.99
- 가능도 $P(B|A')$ : 음성 결과가 나올 확률 = 0.05 (검사의 정확도로부터 계산됨)

우리는 주어진 검사 결과가 양성인 경우, 실제로 질병에 걸렸을 확률을 계산하고 싶습니다. 이를 Bayes' 이론을 사용하여 계산할 수 있습니다.

#### 1. 사후 확률 $P(A|B)$ 계산:

Bayes' 이론을 적용하여 주어진 검사 결과가 양성인 경우, 질병에 걸렸을 확률인 $P(A|B)$를 계산합니다.

$P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}$

#### 2. 주변 확률 $P(B)$ 계산:

주변 확률은 양성 결과가 나올 전체 확률로서, 다음과 같이 계산할 수 있습니다.

$P(B) = P(B|A) \cdot P(A) + P(B|A') \cdot P(A')$

여기서,
- $P(A')$ : 질병에 걸리지 않을 확률 = 1 - $P(A)$
- $P(B|A')$ : 걸리지 않은 사람이 양성 결과를 보일 확률 = 1 - 검사의 정확도

#### 3. 주어진 데이터를 바탕으로 계산:

주어진 정보를 바탕으로 위의 수식에 값을 대입하여 $P(A|B)$를 계산합니다.

이렇게 계산된 $P(A|B)$는 양성 결과가 주어졌을 때 실제로 질병에 걸렸을 확률을 나타냅니다.

이제 이를 수식으로 계산해보겠습니다.

#### 1. 주변 확률 $P(B)$ 계산:

$P(B) = P(B|A) \cdot P(A) + P(B|A') \cdot P(A')$
$P(B) = 0.99 \times 0.01 + 0.05 \times 0.99$
$P(B) = 0.0099 + 0.0495$
$P(B) = 0.0594$

#### 2. 사후 확률 $P(A|B)$ 계산:

$P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}$
$P(A|B) = \frac{0.99 \times 0.01}{0.0594}$
$P(A|B) = \frac{0.0099}{0.0594}$
$P(A|B) ≈ 0.1667$

따라서, 주어진 검사 결과가 양성인 경우, 실제로 질병에 걸렸을 확률은 약 0.1667 또는 약 16.67%입니다.
