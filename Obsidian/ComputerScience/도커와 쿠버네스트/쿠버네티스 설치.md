
---
## 쿠버네티스 설치 전 환경 구축 작업

#### 1. 호스트 이름 변경

##### **작업 명령어**

```bash
hostnamectl set-hostname master.test.com
hostname
```

- 쿠버네티스 클러스터에서 각 노드를 구분하기 위해 고유한 호스트 이름을 설정해야 합니다.
- **FQDN(Fully Qualified Domain Name):** `컴퓨터명.도메인명` 형식으로 작성하며, 네트워크 환경에서 노드의 명확한 식별이 가능합니다.

---
#### 2. Swap 비활성화

##### **작업 명령어**

1. **현재 Swap 상태 확인:**
    ```bash
    swapon -s
    ```
    
2. **Swap 비활성화:**
    ```bash
    swapoff -a
    ```
    
3. **fstab 파일 수정(자동 활성화 방지):**
    ```bash
    nano /etc/fstab
    ```
    
    - 아래 내용을 주석 처리:
        ```
        #/swap.img       none    swap    sw      0       0
        ```

- 쿠버네티스는 메모리 스왑을 사용하지 않는 것을 권장합니다.
    - 스왑이 활성화된 상태에서는 노드의 메모리 관리가 비효율적으로 작동할 가능성이 높아 클러스터 성능에 영향을 미칠 수 있습니다.
- **fstab 수정**은 재부팅 후에도 스왑이 활성화되지 않도록 설정하는 것입니다.

---

#### 3. 리눅스 커널 설정 변경

##### **모듈 로드 설정**

1. **모듈 설정 파일 생성 및 편집:**
    ```bash
    ls /etc/modules-load.d/k8s.conf
    vi /etc/modules-load.d/k8s.conf
    ```
    
2. **다음 내용 추가:**
    ```
    br_netfilter
    ```

##### **커널 매개변수 설정**

1. **설정 파일 생성 및 편집:**
    ```bash
    ls /etc/sysctl.d/k8s.conf
    vi /etc/sysctl.d/k8s.conf
    ```
    
2. **다음 내용 추가:**
    ```
    net.bridge.bridge-nf-call-iptables = 1
    net.bridge.bridge-nf-call-ip6tables = 1
    net.ipv4.ip_forward = 1
    ```

##### **설정 적용**
```bash
systemctl --system
```


- **br_netfilter** 모듈:
    - 브릿지 네트워크 트래픽이 iptables에서 필터링되도록 설정합니다.
    - 쿠버네티스는 브릿지 네트워크를 통해 Pod 간의 통신을 관리하기 때문에 필수적인 설정입니다.
- **커널 매개변수:**
    - `net.bridge.bridge-nf-call-iptables = 1`: 브릿지 네트워크 트래픽을 iptables로 전달합니다.
    - `net.bridge.bridge-nf-call-ip6tables = 1`: IPv6 트래픽도 iptables로 전달합니다.
    - `net.ipv4.ip_forward = 1`: 패킷 포워딩을 활성화하여 Pod 간 통신을 가능하게 합니다.

---
## 쿠버네티스 설치
