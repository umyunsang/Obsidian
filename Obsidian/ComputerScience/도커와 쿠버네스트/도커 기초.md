
---
#### 컨테이너 지우기
```bash
# 종료된 컨테이너 지우기
docker rm [name]

# 실행 중인 컨테이너 강제 지우기
docker rm -f [name]

# 파이프 라인 
docker rm $(docker ps -aq) # 모든 컨테이너 삭제
```
#### MYSQL 설치 및 사용
```bash
# 도커 이미지 설치
docker pull mysql

# mysql은 환경변수 설정이 필수
docker run -d --name [name] -e MYSQL_ROOT_PASSWORD=123 mysql

# 파일로 저장된 환경변수를 불러올 때
docker run -d --name [name] --env-file [name.txt] mysql
```
#### MYSQL 실행
```bash
# -it 옵션 필수
docker exec -it [dbname] bash

# 이후 환경변수 확인
env
```

#### 도커 스토리지
- bind mount : 도커 호스트 디렉터리를 직접 공유하는 방식
- volume : 볼륨을 생성한 후 컨테이너의 디렉터리와 공유하는 방식
- tmpfs : 도커 호스트 메모리에 파일이 저장되는 방식 (영구 저장 x)

```bash
# bin mount
docker run -v [/volume]:[/저장할 디렉토리] [image]

# tmpfs
docker run --tmpfs [path] [image]
```

#### 볼륨 지우기
```bash
docker volume ls

docker volume rm [name]
# 모든 볼륨 지우기
docker volume prune
```
#### 도커 컨테이너 네트워크

![[Pasted image 20250114143924.png]]
- Docker 네트워크 구조를 간단히 정리하면 다음과 같습니다:

1. **컨테이너 내부**
    - **`eth0`**: 컨테이너 내부에 생성되는 네트워크 인터페이스로, 컨테이너의 네트워크 통신을 담당.
2. **도커 호스트 내부**
    - **`docker0`**: Docker 설치 시 생성되는 가상 브리지 인터페이스.
        - 컨테이너와 호스트 간의 네트워크 통신을 연결하는 **다리 역할**을 수행.
    - **`veth`**:
        - 컨테이너의 `eth0`과 도커 호스트의 `docker0`을 연결하는 **가상 인터페이스 페어**.
    - **`en0`**: 도커 호스트가 사용하는 실제 물리적 네트워크 인터페이스.
3. **작동 방식**
    - 컨테이너의 `eth0` ⇔ 호스트의 `veth` ⇔ 호스트의 `docker0`을 통해 통신이 이루어짐.
    - 외부 네트워크와의 통신은 호스트의 `en0`을 통해 처리됨.

#### 사용자 정의 컨테이너 네트워크 
- 컨테이너 이름으로 통신을 하려면 docker0로 연결하면 안됨
- 사용자 정의 네트워크로 연결하여야 컨테이너 이름으로 통신이 됨
```bash
# 브릿지 확인하는 명령어
brctl show
# 랜 카드 확인하는 명령어
ip addr
# 네트워크 만들기
docker network create [name]
# 사용자 지정 네트워크로 컨테이너 열기
docker run --network [image]
```


#### Quiz. 아래 조건에 부합하는  volume 과 사용자 정의 network 를 생성하신후 컨테이너를 연결하여 실행하세요. (소요시간: 30-35분)
```
volume name: dbfile
사용자 정의 네트워크 이름: wordpress_net
  
컨테이너 이름: mysqldb
사용할 이미지: mysql
dbfile volume 이 적용될 디렉토리: /var/lib/mysql
컨테이너 환경변수
        MYSQL_ROOT_PASSWORD: rootpass
        MYSQL_DATABASE: wpdb
        MYSQL_USER: wordpress
        MYSQL_PASSWORD: wordpress
  
컨테이너 이름: web
컨테이너 이미지: wordpress
컨테이너 port number: 80
호스트의 접속할때의 port number: 8080
컨테이너 환경변수
        WORDPRESS_DB_HOST: mysqldb
        WORDPRESS_DB_NAME: wpdb
        WORDPRESS_DB_USER: wordpress
        WORDPRESS_DB_PASSWORD: wordpress

```