
---
![[Pasted image 20241118162543.png]]

---
## 1. 트랜잭션
#### 트랜잭션(transaction)의 개념
- 하나의 작업을 수행하는데 필요한 데이터베이스 연산들을 모아놓은 것 
- 논리적인 작업의 단위 
- 작업 수행에 필요한 SQL 문들의 모임 
	- 특히, 데이터베이스를 변경하는 INSERT, DELETE, UPDATE 문의 실행을 관리 
- 장애 발생 시 복구 작업이나 병행 제어 작업을 위한 중요한 단위로 사용됨 
- 데이터베이스의 **무결성과 일관성을 보장하기 위해** 작업 수행에 필요한 연산들을 **하나의 트랜잭션으로 제대로 정의하고 관리**해야 함
#### 트랜잭션의 예
![[Pasted image 20241118163017.png]]
- 처리 순서는 중요하지 않지만 두 개의 UPDATE 문이 모두 정상적으로 실행되어야 함

![[Pasted image 20241118163045.png]]
- INSERT 문과 UPDATE 문이 모두 정상적으로 실행되어야 상품주문 트랜잭션이 성공적으로 수행됨

#### 트랜잭션의 특성(ACID 특성)
![[Pasted image 20241118163121.png]]
#### 트랜잭션의 특성 – 원자성(atomicity)
- 트랜잭션의 연산들이 **모두 정상적으로 실행되거나 하나도 실행되지 않아야 하는 all-or-nothing 방식을 의미** 
- 만약 트랜잭션 수행 도중 장애가 발생하면? 
	- 지금까지 실행한 연산 처리를 **모두 취소**하고, 데이터베이스를 트랜잭션 작업 **전 상태로 되돌려야 함** 
- 원자성의 보장을 위해 장애 발생 시 회복 기능이 필요
#### 트랜잭션의 특성 – 일관성(consistency)
- 트랜잭션이 성공적으로 수행된 후에도 데이터베이스가 일관된 상태를 유지해야 함을 의미
#### 트랜잭션의 특성 – 격리성(isolation)
- 수행 중인 트랜잭션이 **완료될 때까지** 중간 연산 결과에 **다른 트랜잭션들이 접근할 수 없음**을 의미 
- 격리성의 보장을 위해서는 여러 트랜잭션이 **동시에 수행되더라도** 마치 순서대로 **하나씩 수행되는 것처럼** 정확하고 일관된 결과를 얻을 수 있도록 제어하는 기능이 필요
#### 트랜잭션의 특성 – 지속성(durability)
- 트랜잭션이 성공적으로 완료된 후 데이터베이스에 **반영한 수행 결과는 영구적**이어야 함을 의미 
- 지속성의 보장을 위해서는 장애 발생 시 회복 기능이 필요
####  트랜잭션의 주요 연산
![[Pasted image 20241118165842.png]]
- **commit 연산**
	- 트랜잭션의 수행이 **성공적으로 완료되었음**을 선언하는 연산 
	- commit 연산이 실행되면 트랜잭션의 수행 결과가 데이터베이스에 반영 되고 일관된 상태를 지속적으로 유지하게 됨
- **rollback 연산**
	- 트랜잭션의 **수행이 실패했음**을 선언하는 연산 
	- rollback 연산이 실행되면 트랜잭션이 지금까지 실행한 연산의 결과가 **취소**되고 데이터베이스가 트랜잭션 **수행 전의 일관된 상태로 되돌아감**
#### 트랜잭션의 상태
![[Pasted image 20241118170035.png]]
- 활동(active) 상태 
	- 트랜잭션이 수행되기 시작하여 현재 **수행 중인 상태** 
- 부분 완료(partially committed) 상태 
	- 트랜잭션의 마지막 연산이 **실행을 끝낸 직후의 상태** 
- 완료(committed) 상태 
	- 트랜잭션이 성공적으로 완료되어 commit **연산을 실행한 상태** 
	- 트랜잭션이 수행한 **최종 결과를 데이터베이스에 반영**하고, 데이터베이스가 새로운 일관된 상태가 되면서 트랜잭션이 종료됨
- 실패(failed) 상태 
	- 장애가 발생하여 트랜잭션의 **수행이 중단된 상태** 
- 철회(aborted) 상태 
	- 트랜잭션의 수행 실패로 **rollback 연산을 실행한 상태**
	- 지금까지 실행한 트랜잭션의 연산을 모두 취소하고 트랜잭션이 수행되기 전의 데이터베이스 상태로 되돌리면서 트랜잭션이 종료됨 
	- 철회 상태로 종료된 트랜잭션은 상황에 따라 다시 수행되거나 폐기됨

## 2. 장애와 회복
#### 장애(failure)
- 시스템이 제대로 동작하지 않는 상태
	![[Pasted image 20241118170323.png]]
#### 트랜잭션의 수행을 위해 필요한 데이터 이동 연산
![[Pasted image 20241118170915.png]]
- 디스크와 메인 메모리 간의 데이터 이동 연산 : input / output 
- 메인 메모리와 프로그램 변수 간의 데이터 이동 연산 : read / write