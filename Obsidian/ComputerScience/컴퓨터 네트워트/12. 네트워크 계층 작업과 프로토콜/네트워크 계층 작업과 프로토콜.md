
---
## 1. 네트워크 분할
#### 서브넷 마스크의 특징
![[Pasted image 20241113173513.png]]
- 사물 인터넷 때문에 **IP 주소는 빠른 속도로 고갈**
- 조직의 규모에 따라 C 클래스의 256개는 너무 작고, B 클래스의 65535개는 너무 큼 -> 이러한 문제를 해결하는 방법은 하나의 클래스를 서브넷으로 잘라 여러 개로 나누어 사용하는 것 -> ==**서브넷으로 분할해서 사용할 때 서브넷 마스크가 중요한 역할**==
- **서브넷 마스크에서 1로 표시된 부분은 네트워크 주소, 0으로 표시된 부분은 호스트 주소를 의미.**

![[Pasted image 20241118150649.png]]
- 서브넷 마스크의 특성상 앞에서부터 1이 연달아 나타남
- IP 주소 옆에 1의 개수를 써주면 서브넷 마스크를 간단하게 표현 할 수 있음
- C클래스의 서브넷 마스크는 1이 24개이다. IP 주소 228.152.23.8이 C 클래스라면 228.152.23.8/24로 표시 -> 서브넷 마스크의 1이 앞에서부터 24개 있다는 의미
- B클래스의 서브넷 마스크는 /16, A클래스의 서브넷 마스크는 /8

####  네트워크 분할 방법
![[Pasted image 20241118151224.png]]
- C 클래스는 **원래 256개의 호스트**를 가질 수 있는 네트워크 -> 228.255.75로 시작하는 C 클래스를 A 회사와 B 회사에게 반씩 나누어 준다고 가정
- A 회사는 IP 주소의 마지막 자리인 4번째 자리(호스트 주소)는 이진수로 00000000에서 00000001, 00000010 .... 01111111까지 사용
- 호스트 주소의 **맨 앞 비트가 0으로 시작하는 주소가 A 회사에 속하는 주소**. 십진수로는 228.255.75.0에서 228.255.75.127까지의 주소이며 128개의 호스트 주소를 사용할 수 있음
- B 회사는 2진수 10000000에서 10000001, 10000010 .... 11111111까지의 호스트 주소를 사용
- 호스트 주소의 **맨 앞 비트가 1로 시작하는 주소가 B 회사에 속하는 주소**이며 전체 128개의 호스트 주소를 사용. 십진수로는 228.255.75.128에서 228.255.75.256까지의 주소
- A 회사의 호스트 주소는 2진수로 00000000에서 00000001, 00000010 .... 01111111와 같이 맨 앞 의 첫 비트가 0으로 시작, B 회사의 호스트 주소는 2진수로 10000000에서 10000001, 10000010 .... 11111111와 같이 맨 앞의 첫 비트가 1로 시작.

![[Pasted image 20241118151751.png]]
![[Pasted image 20241118151813.png]]
- 2개로 분할시 서브넷 마스크는 2진수로 11111111 11111111 11111111 10000000이 되어야 함
- 4번째 바이트의 서브넷 마스크가 00000000이 아닌 10000000으로 변경됨 -> 이는 4번째 바이트 의 맨 처음 비트도 네트워크 주소라는 뜻
- 2진수 10000000를 10진수로 바꾸면 128 -> 따라서 C 클래스를 2개의 서브넷으로 나눈 경우 서브넷 마스크는 255.255.255.128이 됨. 간단하게 표시하면 /25가 됨.

#### 서브넷 분할 원리
![[Pasted image 20241118153810.png]]
- **네트워크 주소를 나타내는 1의 개수가 늘어날 때 마다 2의 지수승으로 네트워크는 분할**
- C클래스를 2개의 서브넷으로 분할하면 서브넷 마스크는 11111111 11111111 11111111 10000000이 됨. 10진수로 255.255.255.128이며 /25라 표시
- C 클래스 네트워크를 4개로 분할: 서브넷 마스크가 255.255.255.192. 이는 /26으로 표시
- ex) C 클래스 네트워크를 8개로 분할 할 때 1개의 네트워크 당 호스트 갯수(주소)
	- 256/8 = 32개

![[Pasted image 20241118154054.png]]
- B 클래스의 서브넷 마스크는 255.255.0.0이며 /16
- B 클래스를 2개로 나누면 서브넷 마스크는 255.255.128.0이며 /17 -> 1개의 서브넷이 가질 수 있는 최대 호스트 수는 32768개
- 서브넷 마스크가 255.255.224.0(/19)인 네트워크는 B 클래스를 8개로 분할한 것 -> 1개의 서브넷이 가질 수 있는 최대 호스트 개수는 8192개.
- 네트워크를 분할 할 때 한 번에는 2의 배수로만 분할 할 수 있다고 해서 **네트워크가 짝수로만 만들어지는 것은 아님**
- 네트워크에서 분할을 여러 번 사용하면 홀수개의 서브넷도 만들 수 있음.

## 클래스 기반 네트워크 분할 예제
![[Pasted image 20241118155244.png]]
![[Pasted image 20241118155301.png]]
- 그림의 네트워크를 서브넷팅한 네트워크를 보여준다. 전체 네트워크는 여전히 같은 네트워크를 통하여 연결되어 있다
- 네트워크를 사설 라우터를 이용하여 4개의 서브네트워크로 나누었다
- 인터넷에서 여전히 하나의 네트워크로 보이지만 내부적으로 네트워크는 4개의 서브네트워크로 되어있다
- 각 서브네트워크는 2^14 개의 호스트를 가질 수 있다. 네트워크는 4개의 서로 다른 학부(빌딩)을 가진 대학 캠퍼스에 속할 수 있다
- 서브넷팅 후에, 각 학부는 자신의 서브네트워크를 갖지만, 여전히 전체 캠퍼스는 인터넷에서 하나의 네트워크이다. 그림에서 /16과 /18은 netid와 subnetid의 길이를 나타낸다.

## 클래스 없는 주소 지정
- 클래스 없는 주소 지정 
	- 클래스 기반 주소 지정에서 서브넷팅과 슈퍼넷팅은 실제로 주소 고갈 문제를 해결하지 못함 
	- 인터넷이 성장함에 따라, 장기적으로 보다 큰 주소 공간을 확보하는 것이 필요 
	- 장기적 해결책으로서 IPv6가 개발 
	- 그러나 동일한 주소 공간을 사용하면서 각 기관에 대해 주소를 분배하는 방법이 필요
	- 단기 해결책은 IPv4 주소를 사용하면서 클래스 없는 주소지정(classless addressing)이다
- 가변길이 블록 
	![[Pasted image 20241118155734.png]]
	- 각 기관은 가변길이 블록으로 2^1, 2^2, 2^3, 2^4, 2^5 …2^32개의 주소를 갖는 블록을 지정 가능 
- 2단계 주소 체계 
	![[Pasted image 20241118155751.png]]
	- 프리픽스(Prefix): netid와 동일 기능 
	- 서픽스(suffix): hostid와 동일 기능 
	- 클래스 없는 주소 지정 방식에서 프리픽스의 길이는 0 ~ 32
- 네트워크 마스크
	- 클래스 기반 주소지정 방식에서 정의된 것과 같은 개념 
	- 네트워크 마스크는 32비트 숫자 
	- 왼쪽부터 n개의 연속적인 비트는 1로 설정 
	- 그 나머지 비트는 0으로 설정
- 다음은 슬래시 표현으로 나타낸 주소
	- A. 주소 12.23.24.78/8에서, 네트워크 마스크는 255.0.0.0이다. 즉, 8개의 1과 24개의 0으로 구성. 프리픽스 길이는 8이고, 서픽스 길이는 24이다. (A 클래스와 동일)
	- B. 주소 130.11.232.156/16에서, 네트워크 마스크는 255.255.0.0이다. 즉, 16개의 1과 16개의 0으로 구성. 프리픽스 길이는 16이고, 서픽스 길이는 16이다. (B 클래스와 동일) 
	- C. 주소 167.199.170.82/27에서, 네트워크 마스크는 255.255.255.224이다. 즉, 27개의 1과 5개의 0으로 구성. 프리픽스 길이는 27이고, 서픽스 길이는 5이다. (C 클래스와 동일) -> 224 = 128 + 64 + 32
- 예제 
	- ISP가 1,000개의 주소를 갖는 블록을 요청하였다. 블록은 다음과 같다. 
	- 1,000은 2의 거듭제곱이 아니기 때문에, 1,024개의 주소가 할당된다(1,024 = 2^10) 
	- 블록의 프리픽스 길이는 n = 32 - $log_2{1,024}$ = 22이다. 
	- 18.14.12.0 (1,024로 나누어짐)가 선택된다. 할당된 블록은 18.14.12.0/22이다. 첫 번째 주소는 18.14.12.0/22 이고, 마지막 주소는 18.14.15.255/22이다. (세 번째 바이트가 12~15, 즉 4개를 할당)
- 서브넷팅 
	- 3단계 계층은 서브넷팅을 이용하여 구성 
	- 하나의 블록을 할당 받은 기관(또는 ISP)은 블록을 여러 개의 서브-블록으로 나눈 후에 각 서브-블록을 서브넷에 할당 
	- 서브넷은 여러 개의 서브-서브넷으로 나누어질 수 있다 
	- 서브-서브넷은 다시 서브-서브-서브넷으로 나누어질 수 있다
- 서브넷 설계 
	- 기관이 할당 받은 **주소의 총 개수는 N**이고, **프리픽스 길이는 n**이며, 각 서브넷에게 할당된 주소의 개수는 $N_{sub}$, 각 서브넷의 프리픽스 길이는 $n_{sub}$, 그리고 서브넷의 총 개수는 s라고 하자. 
	- **각 서브넷에 속하는 주소의 개수는 2의 거듭제곱이어야 한다**. 
	- 각 서브넷을 위한 프리픽스 길이는 다음과 같이 구한다
		- $n_{sub} = n + log_2{(N/N_{sub})}$
	- ==**각 서브넷에 속하는 시작 주소는 해당 서브넷에 속하는 주소의 개수로 나누어 질 수 있어야 한다.**==
	- ==**먼저 큰 네트워크에 주소를 설정하고 크기가 작은 네트워크의 주소는 그 다음에 설정하는 등의 단계로 주소 설정**==
- 예제 1 
	- 기관이 블록 130.34.12.64/26을 할당 되었다. 기관은 각각 동일한 개수의 호스트를 갖는 4개 의 서브넷을 구성하고자 한다. 서브넷을 설계하고 각 서브넷에 대한 정보를 구하여라. 
	- 전체 네트워크에 대한 주소의 개수는 N = $2^{32-26}$ = 64이다. 네트워크의 첫 번째 주소는 130.34.12.64/26 이고 마지막 주소는 130.34.12.127/26이다. 이제 서브넷을 설계해 보자: 
	- 첫번째 조건을 만족하도록 각 서브넷에서 16개의 주소를 할당한다.(16은 2의 거듭 제곱). 
	- 각 서브넷에 대한 서브넷 마스크는 /28
- 예제 2 
	- ISP가 190.100.0.0/16(65,536개의 주소)로 시작하는 주소 블록을 할당 받았다. ISP는 이 주소를 다음과 같이 세 그룹의 고객에게 분배하고자 한다: 
		- 첫 번째 그룹은 64개의 고객; 각각은 256개 정도의 주소가 필요 
		- 두 번째 그룹은 128개의 고객; 각각은 128개 정도의 주소가 필요 
		- 세 번째 그룹은 128개의 고객; 각각은 64개 정도의 주소가 필요 
		- 서브-블록을 설계하라, 각 서브-블록에게 주소를 할당한 후에 얼마나 많은 수의 주소가 이용 가능한가?
	- 두 단계로 문제를 해결해 보자. 
	- 첫 번째 단계에서, 주소의 서브블록을 각 그룹에 할당한다. 각 그룹에 할당된 주소의 전체 개수와 각 서브블록에 대한 프리픽스 길이는 다음과 같다.			![[Pasted image 20241120165617.png]]
	- 첫 번째 단계의 설계			![[Pasted image 20241120170252.png]]
	- 두 번째 단계에서, 각 고객에 대한 첫 번째 주소는 서브넷 주소로 사용하고, 마지막 주소는 특수 목적 주소로 예비용으로 둔다			![[Pasted image 20241120170408.png]]
	