
---
# hop-by-hop 통신 (1,2 계층)
## ==1. 프레임==
#### 프레임 만들기
- **데이터 링크 계층의 역할**은 
	- **물리 계층**을 이용하여 **LAN에 속해있는 노드**들에게 **데이터를 전송하는 것**
- 데이터 링크 계층은 네트워크 계층이 보내온 패킷에 데이터 링크 계층이 사용하는 헤더를 붙임 이렇게 만들어진 데이터 단위를 **프레임(frame)이라 부름**
	- **패킷 + 데이터 링크 헤더로 캡슐화된 데이터 = 프레임(frame)**
- 데이터 전송방식은 예고 없이 데이터를 보내는 **비동기식 전송**(저속전송)과 데이터를 전송 한다고 먼저 알려준 후 프레임을 보내는 **동기식 전송**으로 나눌 수 있음. **현재는 동기식 전송 사용**
	![[Pasted image 20241007155217.png]]
- 동기식 전송에서는 데이터를 보내기 전에 통신시작을 알리는 신호가 **플래그**(flag)
- 프레임을 시작할 때와 마찬가지로 프레임이 언제 끝날지를 알려주어야 함
- 앞쪽 플래그를 프리앰블(preamble; 서문), 뒤쪽 플래그를 포스트앰블(postamble)
	![[Pasted image 20241007155508.png]]
- 플래그와 같은 패턴이 있을 경우, 그 앞에 이스케이프 문자(ESC; 구분자)를 삽입하여 전송
	- **스터핑(Stuffing)** : 이스케이프 문자(ESC) 구분자를 넣은 것
	- Data Link End (16번) : DLE
- ‘ESC + 플래그’ 패턴이 들어 있는 경우, ‘ESC + 플래그’ 앞에 ESC를 하나 더 붙여서 보냄
	![[Pasted image 20241007160031.png]]
#### 문자 프레임과 비트 프레임
- 문자 프레임에서는 데이터를 **아스키 코드 형태**로 전송
- 문자 프레임에서 프리앰블은 DLE STX를 붙여서 사용하고 포스트앰블로 DLE ETX를 사용
- STX는 전송 텍스트의 시작을 나타내는 제어문자이며, ETX는 전송 텍스트의 끝을 나타내는 제어문자
- 데이터에 DLE ETX가 나타나는 경우에는 DLE ETX 앞에 DLE를 하나 더 붙여서 전송
	- **문자 스터핑 (charater stuffing)**
- 문자 프레임은 현재 거의 사용하지 않음
	![[Pasted image 20241007160258.png]]
- 대부분은 비트 프레임 방식을 사용
- 비트 프레임에서는 프리앰블과 포스트앰블에 비트 패턴을 사용
	- 프리앰블과 포스트앰블 패턴은 똑같이 01111110 임
	- 0이 나온 후 1이 6개에 연달아 나타난 뒤, 맨 뒤에 0이 붙어서 총 8비트
- 데이터에 플래그와 같은 패턴, 즉 01111110이 나타나면 문제가 발생
- 연달아 나타나는 **1의 다섯 번째** 다음에 0을 하나 삽입 -> **비트 스터핑 (bit stuffing)**
	![[Pasted image 20241007160431.png]]
