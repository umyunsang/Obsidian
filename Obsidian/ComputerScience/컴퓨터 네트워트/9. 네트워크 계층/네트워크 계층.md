
---
## 1. 네트워크 계층 (3계층)
#### 네트워크 계층의 이해
![[Pasted image 20241104134205.png]]
- 네트워크 계층을 대표하는 프로토콜은 IP-Internet Protocol 
- 인터넷에서 LAN들을 지나 데이터를 전달하기 위해 만든 것이 IP
- **IP가 사용하는 데이터는 패킷-packet**
- ==**네트워크 계층의 가장 중요한 역할은 전송계층에서부터 전달된 데이터를 패킷에 넣어 목적지까지 전달하는 것**==
- 모든 패킷은 하나의 길로만 가지 않음 -> 매 순간 가장 빠르다고 생각되는 길로 **떤 길로 패킷을 보낼지를 결정하는 것이 라우팅 혹은 경로배정
- 경로를 결정하는 방법을 정해 놓은 것이 **라우팅 알고리즘**
- 인터넷에서 LAN과 LAN을 연결하는 기계가 **라우터** 혹은 경로 배정 장치 (3계층 통신 장비)
#### 가상 회선(virtual circuit)
![[Pasted image 20241104134956.png]]
- 라우팅의 목적은 목적지까지 **빠르게 데이터**를 전송하는 것, 그림에서 A, B, C, D, E, F는 라우터
- 라우터와 네트워크 상태는 수시로 바뀜 -> 수시로 변하는 라우터의 상태나 네트워크 선의 상태를 고려하여 가장 빠르다고 생각되는 경로로 패킷을 전송
- 먼저 보낸 패킷이 더 늦게 도착하는 경우도 있고, 어떤 패킷은 길을 잘못 들어 목적지에 도착하지 못함 -> ==**IP의 특징을 best efforts, not guarantee라 부름(최선형 프로토콜)**==

![[Pasted image 20241104135010.png]]
- 가상 사설망은 인터넷 망(패킷 교환망)의 **일정 채널을 빌린 후 독점적으로 사용하는 것**
- 인터넷망 서비스 제공업체는 인터넷 망의 여러 채널 중 **A 회사만 사용할 수 있는 채널을 임대(버스 전용차로)**
- 가상 사설망은 기존의 인터넷 망(패킷 교환망)을 **회선 교환망처럼** 사용
	- 가상 사설망에서는 통신을 하기전에 셋업 단계를 거침
	- 셋업 단계를 거친 후 정해진 경로(A-C-F)로만 패킷을 주고 받을 수 있음
	- 순서가 뒤바뀌거나 사라지는 일은 없음
- 가상 사설망을 이용하여 데이터를 보내는 방식이 **가상회선-virtual circuit**
- 가상회선 방식은 패킷교환 방식에서 회선교환을 구현한 형태
- 회선교환, 패킷교환, 가상회선 방식이 어떻게 다른지 다음 표로 정리
	![[Pasted image 20241104145919.png]]

## 2. IP 주소 체계와 설정값
#### IP 설정값에는 무엇이 있는가?
- IP 설정 중 IP 할당을 보면 자동(DHCP)으로 되어 있음
	- 서브넷 마스크, 게이트웨이, DNS (용어 정도 기억)

####  IP 주소 체계의 이해
- LAN에 속한 노드들이 사용하는 주소는 6바이트의 MAC 주소
	- 무작위로 배정된 MAC 주소를 **인터넷에서 사용한다고** 가정하면 통신하려는 노드들이 상대방의 MAC 주소와 위치를 모두 기억하고 있어야 함
	- 수억 대에 이르는 노드가 서로의 위치와 주소를 기억하는 것은 불가능 > **IP 주소 필요**
- IP 주소는 **4바이트**로 구성 -> 각 자리의 주소는** 0에서 255까지의 10진수 값**을 가짐
- IP 주소체계는 전화번호와 똑같지는 않지만, 전화번호처럼 지역코드 개념을 도입
- 일반적으로 사용하는 IP 주소는 **전체 4바이트 중 앞의 3바이트는 네트워크 주소**를 나타냄
	![[Pasted image 20241104151814.png]]
- IP 주소에 지역코드가 있다는 것을 이해하는 것은 중요
	- **계층구조를 가짐**
- **네트워크 주소는 특정지역에 모인 컴퓨터의 집합을 의미**
	![[Pasted image 20241104153024.png]]
- 앞에 3자리가 네트워크 주소를 가리키고, 나머지 한자리가 개별 호스트의 주소를 가리키는 IP 주소 체계가 C 클래스 주소
- B 클래스 주소는 앞의 두 자리가 네트워크 주소이고 뒤의 두 자리가 호스트 주소
- A 클래스 주소는 네트워크 주소가 1바이트 이고, 호스트 주소가 3바이트 인 주소 체계
- D 클래스는 멀티캐스트용 주소이고, E 클래스는 미래를 위해 예약한 주소
- C 클래스 주소의 경우 이론적으로 $2^8$ 대의 컴퓨터를 가질 수 있음 **(192 ~ 223 범위**)
- B 클래스 주소가 가질 수 있는 호스트의 개수는 $2^{16}$ 대 **(128 ~ 191 범위**)
- A 클래스가 가질 수 있는 호스트 개수는 $2^{24}$ 대 **(0 ~ 127 범위**)
- **호스트 주소 0은 네트워크 주소**를 가리키며, **가장 마지막 호스트 주소(255)가 브로드케스트 주소**
- 127로 시작하는 주소는 루프백 (자기 자신에게 돌아오는) 주소

![[Pasted image 20241104154951.png]]

#### 도메인 이름 서비스 (DNS)
- 인터넷에서 통신하기 위해서는 IP 주소가 필요하다. 그러나 4바이트로 이루어진 IP 주소와 같이 비슷한 숫자로 이루어진 값들을 사람들이 잘 기억하지 못함
- 자주 전화 거는 사람들의 전화번호도 기억하기 어려운데, 방문하는 모든 사이트의 IP 주소로 외우는 것은 매우 힘든 일

![[Pasted image 20241104155543.png]]
- 스마트폰의 전화번호부에는 외우기 쉬운 이름이나 별명과 함께 전화번호를 저장
- 인터넷에 있는 IP 주소에 이름을 부여한 것이 **도메인 이름-domain name**
- 도메인 이름에는 규칙이 있음. 대체적으로 “이름.종류.국가” 순
- 도메인 규칙인 “이름.종류.국가”에 어긋나는 경우도 많음

![[Pasted image 20241104160218.png]]
- **도메인 이름을 주면 해당 이름의 IP 주소를** 알려 주는 컴퓨터를 도메인 이름 서비스Domain Name Service, 약자로 DNS라 부름
- ==**DNS는 도메인 이름과 IP 주소를 테이블 형태로 모아놓은 서버**==
- 웹 브라우저에서 도메인 이름을 쓰면 웹 브라우저는 DNS 서버에 접속하여 IP주소를 받아옴 -> 이렇게 받아온 주소를 사용하여 인터넷을 이용하게 되는 것

![[Pasted image 20241104160047.png]]
- DNS의 내부구조를 살펴보면 도메인 이름-IP 주소가 테이블 형태로 되어 있음
- 외부로 부터 도메인 이름이 들어오면 해당 이름을 DNS 테이블에서 검색하여 해당 IP 주소를 돌려줌
- ==**DNS가 고장 나는 것은 흔하지 않은 일이지만, 고장 나면 인터넷이 멈춘 것처럼 보임**==

![[Pasted image 20241104160523.png]]
- **DNS는 계층구조를 가짐** -> DNS 1차 서버 혹은 **루트 서버는 미국에 있음** -> 1대의 루트 서버가 있다면 과부하가 걸려서 멈춰버릴 것임. 또한, DNS 루트 서버가 해킹이나 사고에 의해 멈추면 전 세계 인터넷이 먹통이 됨 -> 각 나라별, 지역별로 DNS 서버를 따로 운영
- DNS 테이블은 DNS 끼리 주기적으로 통신하면서 변경된 값이 있는 경우 새로운 값으로 DNS 테이블을 갱신
- 지역에 있는 DNS의 경우 컴퓨터의 처리용량이나 크기가 루트 DNS 서버에 비하여 매우 작음 -> 지역 DNS 서버는 일부 도메인 이름만 가지고 있음
- 지역 DNS에 도메인 정보가 없는 경우, 루트 DNS에게 주소를 물어 봄 -> **자주 방문하지 않은 사이트를 방문하는 경우에는 루트 DNS 서버까지 갔다와야 하기 때문에 웹브라우저가 조금 늦게 반응**
#### ==서브넷 마스크(subnet mask)==
- 클래스에 따라서 패킷을 처리하는 방법이 달라지기 때문에 호스트는 자신이 속한 네트워크의 주소를 알아야 함 -> 네트워크 주소와 호스트 주소를 알려주는 것이 **서브넷 마스크**
	![[Pasted image 20241106165443.png]]
- IP 주소와 서브넷 마스크는 논리연산 AND를 사용하여 네트워크 주소를 찾음 -> **네트워크 주소자리에 마스크를 1로 만들고, 호스트 주소 자리에 0을 만들면 서브넷 마스크가 됨**
- C 클래스 주소의 서브넷 마스크는 255.255.255.0, B 클래스 주소의 서브넷 마스크는 255.255.0.0 이고, A 클래스 주소의 서브넷 마스크는 255.0.0.0
	![[Pasted image 20241106170012.png]]
#### 게이트웨이(gateway)
- **게이트웨이-gateway란 데이터가 지나다니는 통로라는 의미**
- 게이트웨이는 서로 다른 네트워크의 경계선에 있는 호스트 혹은 장치로써, 종류가 다른 네트워크 혹은 프로토콜의 연결 역할을 하는 장치 혹은 소프트웨어
- 보통의 경우 게이트웨이의 역할은 네트워크와 네트워크의 연결부분에는 있는 **라우터가 담당** -> 그러나 서로 다른 프로토콜을 사용하는 네트워크를 연결하는 경우, 게이트웨이가 중재 역할을 함
- **게이트웨이는 라우터에 전송계층이나 응용계층의 역할이 추가된 것**
