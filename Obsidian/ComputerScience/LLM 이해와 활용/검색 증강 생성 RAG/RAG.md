
---
### RAG (Retrieval-Augmented Generation) 개요

![[Pasted image 20250121150551.png]]

**RAG**는 생성형 AI 모델에 실시간 정보 검색 능력을 결합한 접근 방식입니다. 대형 언어 모델(LLM)이 외부 지식 소스와 연계하여 모델의 범용성과 적응력을 유지하면서도 정확하고 신뢰할 수 있는 답변을 생성할 수 있게 합니다. 주요 응용 분야로는 질문 응답 시스템(QA), 지식 검색, 고객 지원 등이 있습니다.

---

### 챗GPT의 한계와 RAG의 해결책

#### 챗GPT의 한계

1. **고정된 지식**: GPT-3.5까지의 챗GPT는 학습 데이터의 기준 시점에 고정되어 최신 정보를 반영하지 못함.
2. **한정된 도메인 지식**: 특정 분야의 깊이 있는 전문 지식을 제공하는 데 한계가 있음.
3. **맥락 이해의 한계**: 사용자의 특정 상황이나 맥락을 완벽히 이해하고 반영하기 어려움.
4. **환각(Hallucination)**: 잘못된 정보를 사실인 것처럼 제시하는 경우가 있음.

#### RAG의 해결책

1. **최신 정보 접근**: 실시간으로 외부 데이터베이스를 검색하여 최신 정보를 반영 가능.
2. **전문 지식 강화**: 특정 도메인의 전문 데이터베이스를 연결하여 깊이 있는 전문 지식 제공.
3. **맥락 인식 향상**: 사용자의 질문과 관련된 구체적인 정보를 검색하여 더 정확한 맥락 이해 가능.
4. **정보의 신뢰성 향상**: 검색된 실제 데이터를 바탕으로 답변을 생성하여 환각 현상 감소.

---

### RAG 파이프라인

1. **로딩 (Loading)**: 다양한 소스(텍스트 파일, PDF, 웹사이트, 데이터베이스, API 등)에서 데이터를 가져와 파이프라인에 입력.
    - LlamaHub에서 제공하는 다양한 커넥터를 활용할 수 있음.
    
2. **인덱싱 (Indexing)**: 데이터를 쿼리 가능한 구조로 변환.
    - 주로 벡터 임베딩을 생성하여 데이터의 의미를 수치화하고, 관련 메타데이터와 함께 저장.
    
3. **저장 (Storing)**: 생성된 인덱스와 메타데이터를 저장하여 재사용 가능하게 함.
    
4. **쿼리 (Querying)**: LLM과 LlamaIndex 데이터 구조를 활용하여 데이터를 검색.
    - 서브쿼리, 다단계 쿼리, 하이브리드 전략 등 다양한 방식으로 데이터를 검색.
    
5. **평가 (Evaluation)**: 파이프라인의 효과성을 객관적으로 측정.
    - 응답의 정확성, 충실도, 속도 등을 평가.

---

### RAG 작동 원리

1. **색인 작업 (Indexing)**
    - 다양한 외부 데이터 소스(예: 코드 파일, PDF, 텍스트 문서, 이미지 등)에서 정보를 추출.
    - **로드** → **분할** → **임베딩**: 분할된 데이터를 벡터 형태로 변환하고, 벡터 스토어에 저장.
    
2. **Retrieval (검색 단계)**
    - **질문 분석 (Question Analysis)**: 사용자의 질문을 벡터 형태로 변환.
    - **벡터 검색(Vector Search)**: 입력 문장과 관련 있는 문서를 검색 (유사도 검색, TF-IDF, BM25 등).
    
3. **Augmentation (정보 보강 단계)**
    - 검색된 정보를 언어 모델의 입력으로 제공.
    - LLM이 기본적으로 이해하는 언어적 지식에 검색된 데이터를 보강.
    
4. **Generation (생성 단계)**
    - LLM이 보강된 데이터를 바탕으로 자연스러운 텍스트 생성.
    - 응답은 단순히 검색된 내용을 복사하는 것이 아니라, 문맥을 바탕으로 생성.

---

### RAG 장점

1. **시간과 비용 절감**: Fine-tuning에 비해 적은 시간과 비용이 소요됨. 외부 데이터베이스를 활용하므로 별도의 학습 데이터 준비가 필요 없음.
2. **모델의 일반성 유지**: 특정 도메인에 국한되지 않고 다양한 분야에 대한 질문에 답변할 수 있음.
3. **답변의 근거 제공**: 답변과 함께 정보 출처를 제공하여 신뢰도를 높일 수 있음.
4. **할루시네이션 가능성 감소**: 외부 데이터를 기반으로 답변을 생성하여 모델 자체의 오류나 편향을 줄일 수 있음.

---

### Data Load 클래스

**데이터 소스에서 정보를 읽어 들여 처리하는 다양한 클래스들**

- **WebBaseLoader**: 웹 기반 데이터 소스로부터 데이터를 로드 (웹 페이지나 API에서 사용).
- **TextLoader**: 일반 텍스트 데이터를 읽어서 LangChain에서 사용할 수 있는 형태로 변환.
- **DirectoryLoader**: 프로젝트 폴더나 지정된 경로 내의 다수 파일을 일괄적으로 처리.
- **CSVLoader**: 테이블 형태의 데이터를 처리하거나 데이터 분석 작업에 사용.
- **PyPDFLoader**: PDF 파일에서 텍스트를 추출 (PyPDF2 라이브러리 사용).
- **UnstructuredPDFLoader**: 복잡하거나 일정하지 않은 레이아웃을 가진 PDF에서 텍스트 추출.
- **PyMuPDFLoader**: PyMuPDF (Fitz) 라이브러리를 사용하여 PDF 파일로부터 텍스트 추출.
- **OnlinePDFLoader**: 웹 URL을 통해 접근 가능한 PDF 문서 처리.
- **PyPDFDirectoryLoader**: 디렉토리 내의 모든 PDF 파일을 로드하여 데이터를 추출.

---

