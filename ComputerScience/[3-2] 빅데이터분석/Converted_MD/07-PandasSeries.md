# 07-PandasSeries

# 📊 **Pandas Series - 1차원 데이터 구조**

![pandas](images/pandas.png "Pandas Logo")

## 🎯 **개요**

### **학습 목표**
- **Pandas Series 이해**: 1차원 데이터 구조의 핵심 개념
- **데이터 조작**: Series 생성, 인덱싱, 필터링
- **시계열 데이터**: 시간 기반 데이터 처리
- **데이터 시각화**: Series 데이터의 시각화
- **데이터 저장**: HDF5 형식으로 데이터 저장 및 로드

### **Pandas란?**
- **개발자**: Wes MacKinney (2011년 첫 릴리스)
- **기반**: NumPy를 기반으로 한 데이터 분석 라이브러리
- **영감**: R 언어의 데이터 조작 도구에서 영감
- **라이선스**: 오픈 소스 (BSD)
- **용도**: 데이터 분석, 정리, 시각화의 핵심 도구

### **Pandas의 핵심 특징**
- **고성능**: NumPy 기반의 빠른 데이터 처리
- **사용 편의성**: 직관적인 데이터 구조
- **자체 설명**: 데이터 구조가 스스로를 설명
- **파일 지원**: 다양한 파일 형식 지원
- **시각화**: 내장된 플롯팅 함수
- **통계 도구**: 기본적인 통계 분석 기능

### **Pandas 설치 및 임포트**

```python
import pandas as pd
```

### **Pandas의 장점**
- **데이터 구조**: 자체 설명적 데이터 구조
- **파일 처리**: 다양한 파일 형식 지원
- **시각화**: 플롯팅 함수 내장
- **통계 분석**: 기본적인 통계 도구 제공

### 🔧 **환경 설정**

```python
# Jupyter Notebook 설정
%matplotlib inline
%config InlineBackend.figure_format = 'retina'

# 필수 라이브러리 임포트
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# 시각화 설정
sns.set()
pd.set_option("display.max_rows", 8)
plt.rcParams['figure.figsize'] = (9, 6)
```

### 💡 **설정 설명**
- **`%matplotlib inline`**: Jupyter Notebook에서 그래프를 인라인으로 표시
- **`%config InlineBackend.figure_format = 'retina'`**: 고해상도 그래프 출력
- **`sns.set()`**: Seaborn 스타일 적용
- **`pd.set_option("display.max_rows", 8)`**: DataFrame 표시 행 수 제한
- **`plt.rcParams['figure.figsize'] = (9, 6)`**: 그래프 크기 설정

## 📊 **Series - 1차원 데이터 구조**

### **Series란?**
- **정의**: 1차원 배열 데이터와 인덱스 라벨의 조합
- **구조**: 데이터 + 인덱스 (라벨)
- **용도**: 단일 컬럼 데이터를 효율적으로 처리
- **장점**: 인덱스 기반의 빠른 데이터 접근

### **Series의 핵심 특징**
- **1차원 배열**: 단일 차원의 데이터 구조
- **인덱스**: 각 데이터에 대한 라벨 (숫자, 문자열, 날짜/시간)
- **시계열**: 인덱스가 시간 값일 때 시계열 데이터
- **길이 일치**: 인덱스와 데이터의 길이가 동일해야 함
- **자동 생성**: 인덱스가 없으면 `range(len(data))`로 자동 생성

### **Series의 장점**
- **빠른 접근**: 인덱스 기반의 O(1) 데이터 접근
- **유연한 인덱싱**: 다양한 타입의 인덱스 지원
- **시계열 처리**: 시간 기반 데이터 처리에 최적화
- **메모리 효율**: 1차원 구조로 메모리 사용량 최적화

### 🔧 **Series 생성 예제**

```python
# 기본 Series 생성
pd.Series([1,3,5,np.nan,6,8], dtype=np.float64)
```

### 💡 **코드 설명**
- **`pd.Series()`**: Pandas Series 생성 함수
- **데이터**: `[1,3,5,np.nan,6,8]` - 숫자와 NaN 값 포함
- **`dtype=np.float64`**: 데이터 타입을 float64로 지정
- **인덱스**: 자동으로 0, 1, 2, 3, 4, 5 생성

### 🔧 **시계열 Series 생성**

```python
# 날짜 범위를 인덱스로 하는 Series 생성
pd.Series(index=pd.period_range('09/11/2017', '09/18/2017', freq="D"), dtype=np.int8)
```

### 💡 **코드 설명**
- **`pd.period_range()`**: 날짜 범위 생성 (2017년 9월 11일 ~ 18일)
- **`freq="D"`**: 일별 주기로 데이터 생성
- **`dtype=np.int8`**: 데이터 타입을 int8로 지정
- **인덱스**: 날짜가 인덱스로 사용됨

### 🎯 **실습 연습문제**

#### **연습문제 1: 텍스트 생성 및 단어 빈도 계산**
- **목표**: `lorem` 라이브러리를 사용하여 텍스트 생성
- **단계**: 
  1. `lorem` 라이브러리로 텍스트 생성
  2. `collections.Counter`로 단어 빈도 계산
  3. 결과를 딕셔너리로 저장

#### **연습문제 2: Series 생성**
- **목표**: 단어 빈도 결과를 Pandas Series로 변환
- **요구사항**: 
  - Series 이름: `latin_series`
  - 인덱스: 단어를 알파벳 순으로 정렬
  - 데이터: 각 단어의 빈도

### 🔧 **Series 생성 코드**

```python
# 딕셔너리를 Series로 변환
df = pd.Series(result)
df
```

### 💡 **코드 설명**
- **`pd.Series(result)`**: 딕셔너리를 Pandas Series로 변환
- **인덱스**: 딕셔너리의 키가 Series의 인덱스가 됨
- **데이터**: 딕셔너리의 값이 Series의 데이터가 됨
- **결과**: 단어 빈도가 Series 형태로 표시됨

#### **연습문제 3: Series 시각화**
- **목표**: Series 데이터를 막대 그래프로 시각화
- **방법**: `plot()` 함수의 `kind='bar'` 옵션 사용
- **효과**: 단어 빈도를 막대 그래프로 확인

#### **연습문제 4: 인덱싱 연습**
- **목표**: Pandas의 인덱싱 함수 `loc`과 `iloc` 사용
- **`loc`**: 라벨 기반 인덱싱
  - 'dolore' 단어의 빈도 표시
- **`iloc`**: 위치 기반 인덱싱
  - 인덱스의 마지막 단어 빈도 표시

#### **연습문제 5: 정렬 및 시각화**
- **목표**: 단어를 빈도 순으로 정렬하고 시각화
- **단계**:
  1. 단어를 빈도 순으로 정렬
  2. 정렬된 Series를 막대 그래프로 시각화
- **효과**: 빈도가 높은 단어부터 확인 가능

## 🌍 **전 지구 온도 데이터 분석 (1901-2000)**

### **데이터 개요**
- **기간**: 1901년 ~ 2000년 (100년간)
- **데이터**: 전 지구 평균 온도
- **형식**: 텍스트 파일
- **목표**: 데이터 정리 및 시계열 변환

### **데이터 처리 단계**
1. **텍스트 파일 읽기**: pandas로 데이터 로드
2. **데이터 정리**: 결측값 처리 및 데이터 타입 변환
3. **시계열 변환**: DataFrame을 시계열 Series로 변환
4. **시각화**: 온도 변화 추이 확인

### 🔧 **데이터 로드**

```python
import os
here = os.getcwd()

filename = os.path.join(here,"data","monthly.land.90S.90N.df_1901-2000mean.dat.txt")

df = pd.read_table(filename, sep="\s+", 
                   names=["year", "month", "mean temp"])
df
```

### 💡 **코드 설명**
- **`os.getcwd()`**: 현재 작업 디렉토리 확인
- **`os.path.join()`**: 파일 경로 생성
- **`pd.read_table()`**: 텍스트 파일을 DataFrame으로 읽기
- **`sep="\s+"`**: 공백으로 구분된 데이터 파싱
- **`names`**: 컬럼명 지정 (year, month, mean temp)

#### **연습문제 6: 데이터 전처리**
- **목표**: DataFrame을 시계열 Series로 변환
- **단계**:
  1. **컬럼 추가**: "day" 컬럼을 값 1로 추가 (`.insert` 사용)
  2. **인덱스 변환**: DataFrame 인덱스를 datetime으로 변환 (`pd.to_datetime`)
  3. **Series 변환**: "mean temp" 컬럼만 포함하는 Series 생성

#### **연습문제 7: 데이터 탐색**
- **목표**: 데이터의 시작과 끝 부분 확인
- **`.head()`**: 데이터의 처음 5개 행 표시
- **`.tail()`**: 데이터의 마지막 5개 행 표시
- **용도**: 데이터 구조와 내용 파악

### ⚠️ **결측값 처리**

#### **결측값 표시**
- **데이터셋**: -999.00은 해당 연도에 값이 없음을 의미
- **처리 방법**: -999.00을 `np.nan`으로 변환

#### **연습문제 8: 결측값 처리**
- **목표**: 결측값을 식별하고 처리
- **단계**:
  1. **결측값 확인**: -999 값이 있는지 `.values`로 확인
  2. **결측값 변환**: -999.000을 `np.nan`으로 대체

#### **결측값 제거**
- **변환 후**: `np.nan`으로 변환된 결측값은 제거 가능
- **제거 방법**: `.dropna()` 함수 사용

#### **연습문제 9: 결측값 제거**
- **목표**: 결측값이 포함된 행 제거
- **방법**: `.dropna()` 함수 사용
- **효과**: 완전한 데이터만 남김

#### **연습문제 10: 데이터 시각화**
- **목표**: 기본적인 시각화 생성
- **방법**: `.plot()` 함수 사용
- **효과**: 온도 변화 추이를 그래프로 확인

#### **연습문제 11: 시계열 변환**
- **목표**: 인덱스를 timestamp에서 period로 변환
- **이유**: 월별 평균 데이터이므로 period가 더 의미있음
- **방법**: `to_period` 메서드 사용

## 📊 **Resampling - 시계열 데이터 리샘플링**

### **Resampling이란?**
- **정의**: 시계열 데이터의 주기를 변경하는 작업
- **용도**: 데이터의 시간 해상도를 조정하여 분석 용이성 향상
- **종류**: 
  - **Downsampling**: 고주파 데이터를 저주파로 변환 (예: 일별 → 월별)
  - **Upsampling**: 저주파 데이터를 고주파로 변환 (예: 월별 → 일별)

### **주파수 지정**
- **문자열 형식**: "us", "ms", "S", "T", "H", "D", "B", "W", "M", "A"
- **복합 형식**: "3min", "2h20" 등
- **참고**: [Pandas 주파수 별칭](http://pandas.pydata.org/pandas-docs/stable/timeseries.html#offset-aliases)

### **Resampling의 장점**
- **데이터 압축**: 대용량 데이터를 효율적으로 처리
- **트렌드 분석**: 장기적 패턴 파악
- **노이즈 제거**: 단기 변동을 평활화

#### **연습문제 12: 10년 단위 리샘플링**
- **목표**: Series를 10년 단위로 리샘플링
- **방법**: `resample` 메서드 사용
- **효과**: 100년 데이터를 10개 구간으로 압축하여 장기 트렌드 파악

## 💾 **데이터 저장 및 로드**

### **HDF5 파일 형식**
- **정의**: 계층적 데이터 형식 (Hierarchical Data Format version 5)
- **특징**: 바이너리 데이터 저장에 최적화된 강력한 파일 형식
- **용도**: Series와 DataFrame 모두 저장 가능
- **장점**: 
  - **고성능**: 빠른 읽기/쓰기 속도
  - **압축**: 효율적인 데이터 압축
  - **계층구조**: 복잡한 데이터 구조 지원

### 🔧 **데이터 저장**

```python
# HDF5 파일에 Series 저장
with pd.HDFStore("data/pandas_series.h5") as writer:
    df.to_hdf(writer, "/temperatures/full_globe")
```

### 💡 **코드 설명**
- **`pd.HDFStore()`**: HDF5 파일 저장소 생성
- **`with` 문**: 파일 자동 닫기 보장
- **`to_hdf()`**: DataFrame/Series를 HDF5 형식으로 저장
- **경로**: "/temperatures/full_globe" - 계층적 경로 지정

### 🔧 **데이터 로드**

```python
# HDF5 파일에서 Series 읽기
with pd.HDFStore("data/pandas_series.h5") as store:
    df = store["/temperatures/full_globe"]
```

### 💡 **코드 설명**
- **`pd.HDFStore()`**: HDF5 파일 저장소 열기
- **`store[경로]`**: 지정된 경로의 데이터 읽기
- **자동 복원**: 원본 Series/DataFrame 구조 완전 복원
- **효율성**: 바이너리 형식으로 빠른 로드

## 🎯 **학습 목표 달성**

### **이번 실습에서 배운 내용**
- **Series 기본**: 1차원 데이터 구조와 인덱싱
- **데이터 처리**: 결측값 처리, 정렬, 시각화
- **시계열 분석**: 날짜 기반 데이터 처리
- **리샘플링**: 시간 해상도 변경
- **데이터 저장**: HDF5 형식으로 효율적 저장

### **다음 단계**
- **DataFrame**: 2차원 데이터 구조 학습
- **고급 시계열**: 더 복잡한 시계열 분석 기법
- **성능 최적화**: 대용량 데이터 처리 최적화
